policyDefinitions:
  cors:
    origin: "/\\.example2\\.com$/"
    methods:
      - "GET"
      - "POST"
    allowedHeaders:
      - "test-header"
      - "another-header"
  rateLimit:
    rateLimitBy: "ip"
    standardHeaders: "draft-7"
    skipSuccessfulRequests: true
  jwt:
    secret: "${JWT_SECRET}"
    algorithms:
      - "HS256"

endpoints:
  - path: "/todos"
    target:
      url: "https://jsonplaceholder.typicode.com/todos"
    transformedResponse:
      headers:
        test-header: "test"
    policies:
      - jwt
  - path: "/giphy/trending"
    target:
      url: "https://api.giphy.com/v1/gifs/trending"
    transformedRequest:
      query:
        api_key: "${GIPHY_API_KEY}"
        limit: "1"
    policies:
      - cors
      - rateLimit
  - path: "/spotify/artist"
    target:
      url: "https://api.spotify.com/v1/artists/4Z8W4fKeB5YxbusRsdQVPb"
    transformedRequest:
      headers:
        Authorization: "Bearer ${SPOTIFY_TOKEN}"
